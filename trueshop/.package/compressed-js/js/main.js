function putitems(e){var t=document.getElementById("item");content="";for(i=0;i<e.count;i++)content+='<option value="'+e.data[i]+'">'+e.data[i]+"</option>";t.innerHTML=content}function getitems(){$.ajax({type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({ID:2212}),url:"http://api.dataweave.in/v1/commodities/listAllCommodities/?api_key="+api_key,beforeSend:function(){$.mobile.loading("show",{theme:"b",text:"Loading...",textonly:!1,textVisible:!0})},success:function(e){putitems(e)},complete:function(){$.mobile.loading("hide")}})}function go(){item=document.getElementById("item").value,sdate=document.getElementById("sdate").value.replace(/-/g,""),edate=document.getElementById("edate").value.replace(/-/g,"");var e=new Date(document.getElementById("sdate").value),t=new Date(document.getElementById("edate").value),n=new Date;t.getTime()<=n.getTime()?e.getTime()<=t.getTime()?item!=""&&sdate!=""&&edate!=""?(pageno=1,sendgetreq(1)):alert("Fill the fields!"):alert("Start date should not exceed end date!"):alert("Date given should not exceed current date!")}function gocom(){item=document.getElementById("itemcom").value,item!=""?(pageno=1,sendgetreq(2)):alert("Fill the fields!")}function nextpage(e){pageno<Math.ceil(pcount/ppage)?(pageno+=1,sendgetreq(e)):alert("Last page!")}function prevpage(e){pageno>1?(pageno-=1,sendgetreq(e)):alert("No previous page!")}function home(){window.location.reload(!0)}function showdata1(e){var t=document.getElementById("dataspace"),n='<div data-role="main" class="ui-content" style="overflow:auto;"><table data-role="table" data-mode="columntoggle" class="ui-responsive ui-shadow" id="myTable"><thead><tr><th colspan="5"> Price details of '+item+"</th></tr>"+"<tr>"+'<th data-priority="1">Date</th>'+'<th data-priority="2" align="center">Market (State)</th>'+'<th data-priority="3" align="center">Quantity (Tonnes)</th>'+'<th data-priority="4" align="center">Mod. Price (Min - Max)</th>'+'<th data-priority="5" align="center">Origin</th>'+"</tr>"+"</thead><tbody>";pcount=e.count;if(pcount>0){var r=e.count-(pageno-1)*ppage<ppage?e.count-(pageno-1)*ppage:ppage;for(i=0;i<r;i++)n+="<tr>",n+="<td>"+e.data[i].date+"</td>",n+='<td align="center">'+e.data[i].market+" ("+e.data[i].state+")</td>",n+='<td align="center">'+e.data[i].Arrivals_Tonnes+"</td>",n+='<td align="center">'+e.data[i].Modal_Price+e.data[i].unit.substring(0,6)+"("+e.data[i].Minimum_Price+" - "+e.data[i].Maximum_Price+")</td>",n+='<td align="center">'+e.data[i].origin+" </td>",n+="</tr>"}else n+='<tr><td colspan="5" align="center"> No Data available for the item on given date </td></tr>';n+="</tbody></table></div>",pcount>0&&(n+='<div data-role="footer"> <h6><center>',n+="Page "+pageno+" of "+Math.ceil(pcount/ppage)+"",n+="</center></h6></div>"),t.innerHTML=n,document.getElementById("footer1").style.display="none",document.getElementById("footer2").style.display="block"}function openurl(e){var t=window.screen.width/3,n=window.screen.height/3,r,i;r=window.screen.width/2-(t/2+10),i=window.screen.height/2-(n/2+50),window.open(e,item,"status=no,height="+n+",width="+t+",resizable=yes,left="+r+",top="+i+",screenX="+r+",screenY="+i+",toolbar=no,menubar=no,scrollbars=yes,location=no,directories=no")}function showdata2(e){var t=document.getElementById("dataspacecom"),n='<div data-role="main" class="ui-content" style="overflow:auto;"><table data-role="table" data-mode="columntoggle" class="ui-responsive ui-shadow" id="myTable"><thead><tr><th colspan="5"> Price details of '+item+"</th></tr>"+"<tr>"+'<th data-priority="1">Title</th>'+'<th data-priority="2" align="center">MRP</th>'+'<th data-priority="3" align="center">Selling Price</th>'+'<th data-priority="4" align="center">Source</th>'+'<th data-priority="5" align="center">Category</th>'+"</tr>"+"</thead><tbody>";pcount=e.count;if(pcount>0){var r=e.count-(pageno-1)*ppage<ppage?e.count-(pageno-1)*ppage:ppage;for(i=0;i<r;i++)n+="<tr>",n+='<td><a href="#" onclick="openurl(\''+e.data[i].url+"')\">"+e.data[i].title+"</a></td>",n+='<td align="center">'+e.data[i].mrp+"</td>",n+='<td align="center">'+e.data[i].available_price+"</td>",n+='<td align="center">'+e.data[i].source+"</td>",n+='<td align="center">'+e.data[i].category+" </td>",n+="</tr>"}else n+='<tr><td colspan="5" align="center"> No Data available for '+item+" on given date </td></tr>";n+="</tbody></table></div>",pcount>0&&(n+='<div data-role="footer"> <h6><center>',n+="Page "+pageno+" of "+Math.ceil(pcount/ppage)+"",n+="</center></h6></div>"),t.innerHTML=n,document.getElementById("footercom1").style.display="none",document.getElementById("footercom2").style.display="block"}function ajax_request(e,t){$.ajax({type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({ID:2212}),url:e,beforeSend:function(){$.mobile.loading("show",{theme:"b",text:"Fetching data...",textonly:!1,textVisible:!0})},error:function(){$.mobile.loading("hide"),alert("Please check your network connection!")},success:function(e){if(t==1){var n=document.getElementById("dataspace");n.innerHTML="",showdata1(e)}else{var n=document.getElementById("dataspacecom");n.innerHTML="",showdata2(e)}},complete:function(){$.mobile.loading("hide")}})}function sendgetreq(e){var t,n;e==1?n="http://api.dataweave.in/v1/commodities/findByCommodity/?api_key="+api_key+"&commodity="+item+"&start_date="+sdate+"&end_date="+edate+"&page="+pageno+"&per_page="+ppage:n="http://api.dataweave.in/v1/price_intelligence/findProduct/?api_key="+api_key+"&product="+item+"&page="+pageno+"&per_page="+ppage,ajax_request(n,e)}var backEventListener=null,api_key="9ed8e1cfed724312df2db3fabcb4da181b74e25e",pageno,sdate,edate,item,pcount,ppage=10,unregister=function(){backEventListener!==null&&(document.removeEventListener("tizenhwkey",backEventListener),backEventListener=null,window.tizen.application.getCurrentApplication().exit())},init=function(){$("a").bind("taphold",function(e){e.preventDefault()});if(backEventListener!==null)return;pageno=0,item="",sdate="",edate="",pcount=0,console.log("init() called");var e=function(e){if(e.keyName=="back")try{$.mobile.urlHistory.activeIndex<=0?(document.removeEventListener("tizenhwkey",backEventListener),backEventListener=null,window.tizen.application.getCurrentApplication().exit()):($.mobile.urlHistory.activeIndex-=1,$.mobile.urlHistory.clearForward(),pageno-=1,window.history.back())}catch(t){unregister()}};document.addEventListener("tizenhwkey",e),backEventListener=e};$(document).bind("pageinit",init),$(document).unload(unregister)